!function(e){var t={};function o(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(s,n,function(t){return e[t]}.bind(null,n));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=14)}({0:function(e,t,o){"use strict";var s=function(){},n={0:"A new process has been initiated.",1:"Operation successful!",2:"This is a warning message.",3:"Oops! Something went wrong. Please try again."},r={0:"info",1:"success",2:"warning",3:"error"};s.TYPES={INFO:0,SUCCESS:1,WARNING:2,ERROR:3},s.show=function(e,t){var o='<div class="toast custom rounded-5 '+r[e]+'-toast" role="alert" aria-live="assertive" aria-atomic="true"><div class="toast-body d-flex align-items-center gap-5 justify-content-between"><p class="tost-msg mb-0 text-md black d-flex align-items-center gap-3">'+(t||n[e])+'</p><div class="separator"></div><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button></div></div>',s=$(".toast-messaging");s.html(o);var a=s.children().last();new bootstrap.Toast(a[0]).show()},e.exports=s},1:function(e,t,o){"use strict";var s=o(0),n=function(){var e=!1,t=$("#execution_history");if(t.length>0)var o,n=t.data("execution-list-data"),r=n.exportDetailsURL,a=n.showDownloadFile,i=n.downloadFileType,c=n.jobIds,l=n.impexPath,d=setInterval((function(){e||((o=t.find('[data-job-status="PENDING"], [data-job-status="RUNNING"]')).length>0?(e=!0,$.ajax(r,{data:{executionId:o.data("execution-id"),jobIds:c,serviceType:o.data("service-type")?o.data("service-type"):n.serviceType,downloadExportFile:a,downloadFileType:i,impexPath:l},dataType:"json",method:"GET",success:function(e){if(e.success){var n=$(e.renderedTemplate);-1===["PENDING","RUNNING"].indexOf(n.data("job-status"))&&(n.addClass("animate-slide-in-down"),clearInterval(d)),(o=t.find('[data-job-status="PENDING"], [data-job-status="RUNNING"]')).replaceWith(n),setTimeout((function(){t.find("tr").removeClass("animate-slide-in-down")}),1e3)}else e.serverErrors&&e.serverErrors.length>0&&s.show(s.TYPES.ERROR,e.serverErrors[0])},complete:function(){e=!1}})):clearInterval(d))}),3e4)};e.exports={checkProcessStatus:n,handleProcessLink:function(){$(document).on("click",".execution-modal-link",(function(e){e.preventDefault(),$(this).closest("tr").addClass("focused");var t=$(this).closest("tr"),o=$(t).data("job-status"),s=$("#executionModal");if("PENDING"!==o&&"RUNNING"!==o){s.modal("show"),t.closest("tr").addClass("focused");var n=t.find(".execution-modal-link").html(),r=t.closest("tr").data("execution-obj");s.find(".modal-body").spinner().start();var a=r.configurationUUID?r.configurationUUID:"";if(a){var i=$("#execution_history").data("job-logs-url"),c={JobConfigurationUUID:a};$.ajax({url:i,data:c,type:"get",success:function(e){var t,o=$(".log-messages"),a=s.find(".download-section"),i=$(e).find("textarea.inputfield_en").html();switch(""!==$.trim(i)&&o.empty().html(i).removeClass("d-none"),r.executionStatus){case"finished":"OK"===r.status?(t="Success",a.show(),s.find(".download-section a").attr("href",r.exportURL)):(t="Error",a.hide());break;case"aborted":t="Error",a.hide();break;default:t="In-progress",a.hide()}r.processType&&"Import"===r.processType?s.find(".download-section").addClass("d-none"):r.processType&&"Export"===r.processType&&s.find(".download-section").removeClass("d-none");var c='<span class="badge '+t.toLowerCase()+'-badge">'+t+"</span>";s.find(".file-name").empty().html(n.replace(/&lt;/g,"<br/>&lt;")),s.find(".status").empty().html(c),s.find(".time-section .time-message").empty().html(r.timeStatusMessage),s.find(".download-log").attr("href",r.logFileURL),s.find(".modal-body").spinner().stop()}}),s.on("hidden.bs.modal",(function(){$(".table-link").removeClass("focused")}))}}}))},handleCopyLink:function(){$("body").on("click",".log-file-section .copy",(function(e){e.preventDefault();const t=new bootstrap.Tooltip($(this),{trigger:"manual"}),o=$(".log-file-section .log-messages");if(o.length){const e=$(o).text();""!==$.trim(e)&&(navigator.clipboard.writeText(e),t.show(),setTimeout((function(){t.hide()}),1e3))}}))},refreshExecutionList:function(){$(document).on("click",".refresh-execution-list",(function(e){e.preventDefault();var t=$("#execution_history"),o=t.data("execution-list-data"),r=o.exportDetailsURL,a=o.showDownloadFile,i=o.downloadFileType,c=o.jobIds,l=o.impexPath,d=o.maxProcessNumber;t.spinner().start(),$.ajax(r,{data:{jobIds:c,serviceType:o.serviceType,downloadExportFile:a,downloadFileType:i,impexPath:l,maxProcessNumber:d},dataType:"json",method:"get",success:function(e){e.success?($(".execution-list").html(e.renderedTemplate),$(".execution-list").find("tr[data-job-status=RUNNING], tr[data-job-status=PENDING]")&&n(),t.spinner().stop()):e.serverErrors&&e.serverErrors.length>0&&(s.show(s.TYPES.ERROR,e.serverErrors[0]),t.spinner().stop())},complete:function(){$(".refresh-execution-list").blur()}}),$(".refresh-execution-list").blur()}))},validateNoRunningProcess:function(){var e=!0,t=$("#execution_history");if(t.find('[data-job-status="PENDING"], [data-job-status="RUNNING"]').length>0){var o=t.data("running-process-error");s.show(s.TYPES.INFO,o),e=!1}return e}}},14:function(e,t,o){"use strict";var s=o(1),n=o(0);$(document).ready((function(){$("form.search-coupon").on("submit",(function(e){var t=$(this);e.preventDefault();var o=t.attr("action");$("body").spinner().start(),$.ajax({url:o,data:t.serialize(),type:"get",success:function(e){t.spinner().stop();var o=$(".coupon-list-table");e.success?o.html(e.renderedTemplate):e.serverErrors&&e.serverErrors.length&&$.each(e.serverErrors,(function(e,t){n.show(n.TYPES.ERROR,t)})),$("#nav-coupons-tab").tab("show")},error:function(){$("body").spinner().stop()}})})),$(document).on("click",".select-coupon",(function(e){var t=$(".coupon-list-form");e.preventDefault(),$("body").spinner().start();var o=t.data("action-url"),s=$(this).closest(".coupon-item").data("coupon-json");s&&($("#replicate-coupon-modal .modal-body").empty(),$.ajax({url:o,data:s,type:"get",success:function(e){if($("body").spinner().stop(),e.success){$("#replicate-coupon-modal .modal-body").html(e.renderedTemplate);!!$("#replicate-coupon-modal .site-name .site-id:not(.disable)").length||$("#replicate-coupon-modal .replication-coupon").addClass("disabled"),0===$("#replicate-coupon-modal .site-name .site-id:checked").length&&$("#replicate-coupon-modal .replication-coupon").addClass("disabled")}else e.serverErrors&&e.serverErrors.length&&$.each(e.serverErrors,(function(e,t){n.show(n.TYPES.ERROR,t)}))},error:function(){$("body").spinner().stop()}}))}));$(document).on("click",".replication-coupon",(function(e){e.preventDefault();for(var t=$(".replication-coupon-form"),o=t.data("case-insensitive"),r=t.data("multiple-codes"),a=t.data("coupon-type"),i=t.data("action-url"),c=t.data("coupon-id"),l=t.data("coupon-description"),d=$(".site-id.selected"),u=[],p=0;p<d.length;p++)u.push($(d[p]).val());var f={couponId:c,siteIdsArray:JSON.stringify(u),caseInsensitive:o,multipleCodesPerBasket:r,couponType:a,couponDescription:l};s.validateNoRunningProcess()&&($("#execution_history").spinner().start(),$.ajax({url:i,data:f,type:"post",success:function(e){$("#execution_history").spinner().stop();var t=$("#execution_history").find(".table"),o=e.renderedTemplate;e.success?(t.find("tbody tr").length>=5&&t.find("tbody tr:last").remove(),t.find("tbody").prepend(o),s.checkProcessStatus()):e.serverErrors&&e.serverErrors.length&&$.each(e.serverErrors,(function(e,t){n.show(n.TYPES.ERROR,t)})),function(){$("#replicate-coupon-modal").modal("hide");new bootstrap.Tab("#nav-replications-tab").show()}()},error:function(){$("#execution_history").spinner().stop()}}))})),$("body").on("click",".site-id",(function(){$(this).toggleClass("selected"),$("#replicate-coupon-modal .replication-coupon").toggleClass("disabled",!$(this).closest(".items").find(".site-id:checked").length)})),$(document).on("click",".coupon-id-column, .coupon-description-column, .coupon-type-column, .coupon-enable-column",(function(e){e.preventDefault();var t=$(".search-coupon").attr("action"),o=$(".coupon-table"),s=o.data("coupon-id"),r=$("#pageSize").find(":selected").val(),a="asc";o.hasClass("sorting")&&(a="asc"===o.data("sort-rule")?"desc":"asc");var i={couponSearchTerm:s,count:r,sortRule:a,sortBy:$(this).data("sort-type")};$(".coupon-list-table").spinner().start(),$.ajax({url:t,data:i,type:"get",success:function(e){$(".coupon-list-table").spinner().stop(),e.success?$(".coupon-list-table").html(e.renderedTemplate):e.serverErrors&&e.serverErrors.length&&$.each(e.serverErrors,(function(e,t){n.show(n.TYPES.ERROR,t)}))},error:function(){$(".coupon-list-table").spinner().stop()}})}))}))}});